<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<title>MaybeLegal Shop3D</title>

		<link rel="stylesheet" type="text/css" href="MaybeLegal_Shop3D.css">

		<script type="text/javascript" src="libs/jquery-1.9.1.js"></script>
		<script type="text/javascript" src="MaybeLegal_Shop3D.js"></script>
		<script type="text/javascript" src="randomComposition.js"></script>
	</head>
	<body>
		<div class="mb-gif-wrapper">
			<img class="mb-gif" src=""></img>
		</div>

		<div class="title"></div>

		<menu class="mainMenu">
			<a href="something.html"><div class="menu_button menu_about">about</div></a>
			<a href="something.html"><div class="menu_button menu_catalogue">catalogue</div></a>
			<a href="something.html"><div class="menu_button menu_generator">generate</div></a>
			<a href="something.html"><div class="menu_button menu_tumblr">tumlr</div></a>
		</menu>

		<div class="shirt-index-wrapper">
			<a class="buy-link" href="http://www.something1.html">
				<img class="shirt" src="imgs/small_shirts/shirt1.png">
			</a>
			<a class="buy-link" href="http://www.something2.html">
				<img class="shirt" src="imgs/small_shirts/shirt2.png">
			</a>
			<a class="buy-link" href="http://www.something3.html">
				<img class="shirt" src="imgs/small_shirts/shirt3.png">
			</a>
			<a class="buy-link" href="http://www.something4.html">
				<img class="shirt" src="imgs/small_shirts/shirt4.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt5.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt6.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt7.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt8.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt9.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt10.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt11.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt12.png">
			</a>
			<a class="buy-link" href="http://www.something1.html">
				<img class="shirt" src="imgs/small_shirts/shirt1.png">
			</a>
			<a class="buy-link" href="http://www.something2.html">
				<img class="shirt" src="imgs/small_shirts/shirt2.png">
			</a>
			<a class="buy-link" href="http://www.something3.html">
				<img class="shirt" src="imgs/small_shirts/shirt3.png">
			</a>
			<a class="buy-link" href="http://www.something4.html">
				<img class="shirt" src="imgs/small_shirts/shirt4.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt5.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt6.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt7.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt8.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt9.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt10.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt11.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt12.png">
			</a>
			<a class="buy-link" href="http://www.something1.html">
				<img class="shirt" src="imgs/small_shirts/shirt1.png">
			</a>
			<a class="buy-link" href="http://www.something2.html">
				<img class="shirt" src="imgs/small_shirts/shirt2.png">
			</a>
			<a class="buy-link" href="http://www.something3.html">
				<img class="shirt" src="imgs/small_shirts/shirt3.png">
			</a>
			<a class="buy-link" href="http://www.something4.html">
				<img class="shirt" src="imgs/small_shirts/shirt4.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt5.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt6.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt7.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt8.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt9.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt10.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt11.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt12.png">
			</a>
			<a class="buy-link" href="http://www.something1.html">
				<img class="shirt" src="imgs/small_shirts/shirt1.png">
			</a>
			<a class="buy-link" href="http://www.something2.html">
				<img class="shirt" src="imgs/small_shirts/shirt2.png">
			</a>
			<a class="buy-link" href="http://www.something3.html">
				<img class="shirt" src="imgs/small_shirts/shirt3.png">
			</a>
			<a class="buy-link" href="http://www.something4.html">
				<img class="shirt" src="imgs/small_shirts/shirt4.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt5.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt6.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt7.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt8.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt9.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt10.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt11.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt12.png">
			</a>
			<a class="buy-link" href="http://www.something1.html">
				<img class="shirt" src="imgs/small_shirts/shirt1.png">
			</a>
			<a class="buy-link" href="http://www.something2.html">
				<img class="shirt" src="imgs/small_shirts/shirt2.png">
			</a>
			<a class="buy-link" href="http://www.something3.html">
				<img class="shirt" src="imgs/small_shirts/shirt3.png">
			</a>
			<a class="buy-link" href="http://www.something4.html">
				<img class="shirt" src="imgs/small_shirts/shirt4.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt5.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt6.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt7.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt8.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt9.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt10.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt11.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt12.png">
			</a>
			<a class="buy-link" href="http://www.something1.html">
				<img class="shirt" src="imgs/small_shirts/shirt1.png">
			</a>
			<a class="buy-link" href="http://www.something2.html">
				<img class="shirt" src="imgs/small_shirts/shirt2.png">
			</a>
			<a class="buy-link" href="http://www.something3.html">
				<img class="shirt" src="imgs/small_shirts/shirt3.png">
			</a>
			<a class="buy-link" href="http://www.something4.html">
				<img class="shirt" src="imgs/small_shirts/shirt4.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt5.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt6.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt7.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt8.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt9.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt10.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt11.png">
			</a>
			<a class="buy-link" href="http://www.something5.html">
				<img class="shirt" src="imgs/small_shirts/shirt12.png">
			</a>
		</div>


		<script src="libs/three.min.js"></script>

		<script src="libs/tween.min.js"></script>
		<script src="libs/CSS3DRenderer.js"></script>

		<div id="container"></div>
		<div id="search"><input id="query" type="text" value="cats"><button id="button">search</button></div>

		

		<script>
			var camera, scene, renderer;
			var objects = [], player;

			var auto = true;

			//** -- MAYBE LEGAL -- **//
			var shirtArrayIndex = 0;
			var shirts = $('.shirt-index-wrapper').find('img');

			var buyLinksArrayIndex = 0;
			var buyLinks = $('.buy-link');

			console.log(buyLinks.length);
			// console.log(shirts[shirtArrayIndex].src);
			// console.log(buyLinks[buyLinksArrayIndex].href);

			//** -- -- **//

			

			init();
			animate();

			function init() {

				camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 1, 5000 );
				camera.position.y = - 25;

				scene = new THREE.Scene();

				renderer = new THREE.CSS3DRenderer();
				renderer.setSize( window.innerWidth, window.innerHeight );
				renderer.domElement.style.position = 'absolute';
				renderer.domElement.style.top = 0;
				document.getElementById( 'container' ).appendChild( renderer.domElement );

				//

				var query = document.getElementById( 'query' );
				query.addEventListener( 'keyup', function ( event ) {

					if ( event.keyCode === 13 ) {

						search( query.value );

					}

				}, false );

				var button = document.getElementById( 'button' );
				button.addEventListener( 'click', function ( event ) {

					search( query.value );

				}, false );

				if ( window.location.hash.length > 0 ) {

					query.value = window.location.hash.substr( 1 );

				}

				search( query.value );

				document.body.addEventListener( 'mousewheel', onMouseWheel, false );

				document.body.addEventListener( 'click', function ( event ) {

					auto = true;

					if ( player !== undefined ) {

						player.parentNode.removeChild( player );
						player = undefined;

					}

					new TWEEN.Tween( camera.position )
							.to( { x: 0, y: - 25 }, 1500 )
							.easing( TWEEN.Easing.Exponential.Out )
							.start();

				}, false );

				window.addEventListener( 'resize', onWindowResize, false );

			}

			function search( query ) {

				//window.location.hash = "query";

				for ( var i = 0, l = objects.length; i < l; i ++ ) {

					var object = objects[ i ];
					var delay = Math.random() * 1000;

					new TWEEN.Tween( object.position )
							.to( { y: - 3000 }, 1000 )
							.delay( delay )
							.easing( TWEEN.Easing.Exponential.In )
							.start();

					new TWEEN.Tween( object )
							.to( {}, 2000 )
							.delay( delay )
							.onComplete( function () {

								scene.remove( this );
								renderer.cameraElement.removeChild( this.element );

								var index = objects.indexOf( this );
								objects.splice( index, 1 );

							} )
							.start();

				}

				var request = new XMLHttpRequest();
				request.addEventListener( 'load', onData, false );
				request.open( 'GET', 'https://gdata.youtube.com/feeds/api/videos?v=2&alt=json&max-results=50&q=' + query, false );
				request.send( null );

			}

			function onData( event ) {

				var data = JSON.parse( event.target.responseText );
				var entries = [];

				// for loop that pushes the number of items in the scene
				for (i = 0; i < 60; i++) {
					var arrayNum = i;
					entries.push(i);
				}

				// console.log( entries.length );

				for ( var i = 0; i < entries.length; i ++ ) {

					var entry = entries[ i ];

					var element = document.createElement( 'div' );
					element.style.width = '480px';
					element.style.height = '360px';

					var image = document.createElement( 'img' );
					image.addEventListener( 'load', function ( event ) {

						var object = this.properties.object;
						var button = this.properties.button;

						button.style.visibility = 'visible';

						new TWEEN.Tween( object.position )
							.to( { y: Math.random() * 2000 - 1000 }, 2000 )
							.easing( TWEEN.Easing.Exponential.Out )
							.start();

					}, false );
					image.style.position = 'absolute';
					image.style.width = '480px';
					// image.style.height = '360px';
					image.src = shirts[shirtArrayIndex].src;
					element.appendChild( image );

					// current array with link to item in the aparrel store
					var currentLink = buyLinks[buyLinksArrayIndex].href

					// var button = document.createElement( 'img' );
					// button.style.position = 'absolute';
					// button.style.left = ( ( 480 - 86 ) / 2 ) + 'px';
					// button.style.top = ( ( 360 - 61 ) / 2 ) + 'px';
					// button.style.visibility = 'hidden';
					// button.style.WebkitFilter = 'grayscale()';
					// button.src = 'data:image/png;base64,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';
					// element.appendChild( button );

					var blocker = document.createElement( 'div' );
					blocker.style.position = 'absolute';
					blocker.style.width = '0px';
					blocker.style.height = '0px';
					blocker.style.background = 'rgba(0,0,0,0)';
					blocker.style.cursor = 'pointer';
					element.appendChild( blocker );

					var object = new THREE.CSS3DObject( element );
					object.position.x = Math.random() * 4000 - 2000;
					// object.position.y = Math.random() * 2000 - 1000;
					object.position.y = 3000;
					object.position.z = Math.random() * - 20000;
					scene.add( object );

					objects.push( object );

					//

					var properties = { data: entry, blocker: blocker, button: button, object: object }

					element.properties = properties;
					image.properties = properties;

					element.addEventListener( 'mouseover', function () {

						this.properties.button.style.WebkitFilter = '';
						this.properties.blocker.style.background = 'rgba(0,0,0,0)';

					}, false );

					element.addEventListener( 'mouseout', function () {

						this.properties.button.style.WebkitFilter = 'grayscale()';
						this.properties.blocker.style.background = 'rgba(0,0,0,0)';

					}, false );

					element.addEventListener( 'click', function ( event ) {

						event.stopPropagation();

						var data = this.properties.data;
						var object = this.properties.object;

						auto = false;

						if ( player !== undefined ) {

							player.parentNode.removeChild( player );
							player = undefined;

						}

						link = document.createElement('a');
						link.className = "buyLink-button";
						link.href = currentLink;

						div2 = document.createElement('div');
						div2.className = "shirtInfo-bgOffset";


						player = document.createElement( 'div' );
						player.className = "shirtInfo";

						
						player.appendChild(link);
						player.appendChild(div2);

						var player_JQueryObject = $(player);

						this.appendChild( player );

						// add any animations after appending the element
						player_JQueryObject.animate({"height": "400px", "opacity": .9}, 500);

						var prev = object.position.z + 400;

						new TWEEN.Tween( camera.position )
							.to( { x: object.position.x, y: object.position.y - 25 }, 1500 )
							.easing( TWEEN.Easing.Exponential.Out )
							.start();

						new TWEEN.Tween( { value: prev } )
							.to( { value: 0  }, 2000 )
							.onUpdate( function () {

								move( this.value - prev );
								prev = this.value;

							} )
							.easing( TWEEN.Easing.Exponential.Out )
							.start();

					}, false );

				//increments the shirtArrayIndex and buyLinksArrayIndex
				console.log(buyLinks[buyLinksArrayIndex].href);
				shirtArrayIndex++;
				buyLinksArrayIndex++;
				}

			}

			function move( delta ) {

				for ( var i = 0; i < objects.length; i ++ ) {

					var object = objects[ i ];

					object.position.z += delta;

					if ( object.position.z > 0 ) {

						object.position.z -= 20000;

					} else if ( object.position.z < - 20000 ) {

						object.position.z += 20000;

					}

				}

			}

			function onMouseWheel( event ) {

				move( event.wheelDelta );

			}

			function onWindowResize() {

				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();

				renderer.setSize( window.innerWidth, window.innerHeight );

			}

			function animate() {

				requestAnimationFrame( animate );

				TWEEN.update();

				if ( auto === true ) {

					move( 1 );

				}

				renderer.render( scene, camera );

			}

		</script>
	</body>
</html>
